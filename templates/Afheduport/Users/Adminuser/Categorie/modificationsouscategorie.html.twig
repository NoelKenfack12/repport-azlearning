{% extends "Theme/Users/Adminuser/layoutadmin.html.twig" %}
{% block meta %}
	{{ parent() }}
	<meta name="keywords" content="{{ site }}, Business, Innovation,Administration"/>
	<meta name="author" content="Noel Kenfack"/>
	<meta name="description" content="{{ site }} | Inscription | Cameroun | {{ metier }}" />
{% endblock %}
{% block title %}
{{ parent() }} | Accueil Admin
{% endblock %}

{% block userblog_body %}
<hr style="margin-top: 45px; margin-bottom: 0px;"/>
<div  style="background: rgba(83, 101, 240, 1); height: 10px;">
</div>
<div style="background: #BDC3C7;">
	<div class="container" style="color: #fff;">
	Accueil <span class="mdi-av-play-arrow" style="font-size: 10px;"></span>  Administration
	</div>	
</div>	
<hr style="margin-bottom: 0px;">
<!--content-->
<div class="product" style="padding-top: 20px; margin-bottom: 20px;">
	<div class="container" style="padding: 0px;">
	<div class="col-lg-12 animecourant-panel">
	</div>
		<div class="col-md-4 product-bottom">
		{{ render(controller("App\\Controller\\Users\\Adminuser\\AccueilController:menuadmin")) }}
		<!---->
		</div>
		<div class="col-md-8 panel panel-widget" style="padding: 0px;">
		<div class="header-card" style="margin-bottom: 7px;">
			<div style="padding: 7px; color: #fff;">Modification des modules de formation.</div>	
		</div>
		
		<div style="border: 1px solid #ddd; padding-bottom: 7px; margin-bottom: 7px;">
		<div style="background: #f7f7f7; border-bottom: 1px solid #ddd; margin: -5px 0px 7px 0px;">
			<h2 style="margin: 5px;">Modification de la liste {{ scat.nom }}.</h2>	
		</div>
		<h4 class="title">
		{% for infos in app.session.flashbag.get('information') %}
		{% if loop.first %}
		<div class="alert alert-warning alert-dismissable" style="margin: 3px;">
		<button type="button" class="close" data-dismiss="alert">&times;</button>
		{{ infos|raw }}
		</div>
		{% endif %}
		{% endfor %}
		</h4> 
		
		{{ form_start(formcat, {'attr': {'class': 'submit-souscategorie','action': path('users_adminuser_modifier_sous_categorie_produit', {'id': scat.id}) }}) }}
		<div class="col-sm-6">
			 <span style="color:red;">{{ form_errors(formcat) }}</span>
			 <span style="color:red;">{{ form_errors(formcat.nom) }}</span>
			 <div class="form-group champ6">
				{{ form_widget(formcat.nom, {'attr': {'class': 'form-control'}}) }}
			</div>
			 <div class="alert alertnotif6 alert-block alert-danger alert-dismissable" style="display:none; padding: 3px;">
			 <button type="button" class="close" data-dismiss="alert" style="margin-right: 25px;">&times;</button>
			 <h4 style="margin-bottom: 0px;">Erreur </h4>
			 Taille invalide !!! <span class="label label-info pull-right control-info-champ6"></span>
			 </div>
			 <span style="color:red;">{{ form_errors(formcat.contenu) }}</span>
			 <div class="form-group champ7">
				{{ form_widget(formcat.contenu, {'attr': {'class': 'form-control'}}) }}
			</div>
			<div class="alert alertnotif7 alert-block alert-danger alert-dismissable" style="display:none; padding: 3px;">
			 <button type="button" class="close" data-dismiss="alert" style="margin-right: 25px;">&times;</button>
			 <h4 style="margin-bottom: 0px;">Erreur </h4>
			 Taille invalide !!! <span class="label label-info pull-right control-info-champ7"></span>
			</div>
			<span style="color:red;">{{ form_errors(formcat.rang) }}</span>
			<div class="form-group champ8">
			{{ form_widget(formcat.rang , {'attr': {'class': 'form-control'}}) }}
			</div>
			<div class="alert alertnotif8 alert-block alert-danger alert-dismissable" style="display:none; padding: 3px;">
			  <button type="button" class="close" data-dismiss="alert" style="margin-right: 25px;">&times;</button>
			  <h4 style="margin-bottom: 0px;">Erreur </h4>
			  Entier positif !!! <span class="label label-info pull-right control-info-champ8"></span>
			</div>
		</div>
		  <div class="col-sm-6">	
			<span style="color:red;">{{ form_errors(formcat.categorie) }}</span>
			<div class="form-group">
				{{ form_widget(formcat.categorie, {'attr': {'class': 'form-control'}}) }}
			</div>
			<span style="color:red;">{{ form_errors(formcat.file) }}</span>
			<span>{{ form_label(formcat.file,'Lier une image descriptive de la nouvelle liste') }}</span>
			<div class="form-group champ9">
				{{ form_widget(formcat.file) }}
			</div>
			 <div class="alert alertnotif9 alert-block alert-danger alert-dismissable" style="display:none; padding: 3px;">
			  <button type="button" class="close" data-dismiss="alert" style="margin-right: 25px;">&times;</button>
			  <h4 style="margin-bottom: 0px;">Erreur </h4>
			  Fichier invalide !!! <span class="label label-info pull-right control-info-champ9"></span>
			 </div>
			 <div class="form-group" style="margin-top: 15px;">
				<button class="btn btn-primary">Enregistrez le nouveau module</button>
			 </div>
		  </div>

		 <div class="clearfix"></div>
		 {{ form_end(formcat) }} 
				
		<div class="clearfix"></div>
		</div>
		
		<div style="background: #f7f7f7; border: 1px solid #ddd; margin-bottom: 7px;">
				<h2 style="margin: 5px;">Toutes les listes de la section {{ scat.categorie.nom }}</h2>	
		</div>

		<div style="padding: 5px 0px;">
		<div class="liste_souscategorie_{{ scat.categorie.id }}">
			{{ render(controller("App\\Controller\\Produit\\Produit\\CategorieController:listecategorie", {'id': scat.categorie.id, 'pagesuivante': 1})) }}
		</div>
		<div class="clearfix"></div>
		</div>

		</div>
	</div class="clearfix"></div>
	</div>

<hr>
<script src="{{ asset('template/assets/js/onvisible.js') }}" type="text/javascript"></script>

<script>
var maxchamp3 = 100;
var minchamp3 = 3;
var maxchamp4 = 300;
var minchamp4 = 0;
var extensionsImgValides= new Array({{ imagesite|raw }});
var maximgsize = 1500000;
$(".submit-souscategorie").on("submit", function() {
if($('#produit_produitbundle_souscategorie_nom').val().length < minchamp3 || $('#produit_produitbundle_souscategorie_nom').val().length > maxchamp3){
$("div.champ6").addClass("has-error");
$("div.alertnotif6").show("slow").delay(6000).hide("slow");
$('.control-info-champ6').html($('#produit_produitbundle_souscategorie_nom').val().length+'/'+maxchamp1);
$('#produit_produitbundle_souscategorie_nom').focus();
return false;
}
if($('#produit_produitbundle_souscategorie_contenu').val().length != minchamp4 && $('#produit_produitbundle_souscategorie_contenu').val().length > maxchamp4){
$("div.champ7").addClass("has-error");
$("div.alertnotif7").show("slow").delay(6000).hide("slow");
$('.control-info-champ7').html($('#produit_produitbundle_souscategorie_contenu').val().length+'/'+maxchamp1);
$('#produit_produitbundle_souscategorie_contenu').focus();
return false;
}
if(!is_int($('#produit_produitbundle_souscategorie_rang').val()) || $('#produit_produitbundle_souscategorie_rang').val() < 0){
$("div.champ8").addClass("has-error");
$("div.alertnotif8").show("slow").delay(6000).hide("slow");
$('.control-info-champ8').html('Not Int');
$('#produit_produitbundle_souscategorie_rang').focus();
return false;
}

if(scriptVerifFile('produit_produitbundle_souscategorie_file',extensionsImgValides,maximgsize) == false)
{
	$("div.champ9").addClass("has-error");
	$("div.alertnotif9").show("slow").delay(6000).hide("slow");
	$('.control-info-champ9').html('Image; Size: <'+Math.floor(maximgsize/1000)+'Ko');
	return false;
}
});

function is_int(value){
  if((parseFloat(value) == parseInt(value)) && !isNaN(value)){ 
      return true;
  } else {
      return false;
  }
}
function getExtension(filename)
{
	var parts = filename.split(".");
	return (parts[(parts.length-1)]);
}    

function scriptVerifFile(champ,listeExt,taillemax)
{
var files = $('#'+champ)[0].files;
if (files.length > 0){
file = files[0],
filename = file.name;
filesize = file.size;
}else{
filename = '';
filesize = 0;
return (true);
}
if(filesize == 0 || filesize > taillemax)
{
	return (false);
}
fileExt = getExtension(filename);
for (i=0; i<listeExt.length; i++)
{
	if ( fileExt == listeExt[i] ) 
	{
		return (true);
	}
}
return (false);
}

var taille2 = "";
$('#produit_produitbundle_souscategorie_nom').keyup(function(){
if(taille2.length >= maxchamp3 && $(this).val().length >= maxchamp3)
{
	$(this).val(taille2);
	$("div.champ6").addClass("has-error");
	$("div.alertnotif6").show("slow");
	$('.control-info-champ6').html(taille2.length+'/'+maxchamp3);
	$('#produit_produitbundle_souscategorie_nom').focus();
}else{
	  taille2 = $(this).val();
}
});

var taille3 = "";
$('#produit_produitbundle_souscategorie_contenu').keyup(function(){
if(taille3.length >= maxchamp4 && $(this).val().length >= maxchamp4)
{
	$(this).val(taille3);
	$("div.champ7").addClass("has-error");
	$("div.alertnotif7").show("slow");
	$('.control-info-champ7').html(taille3.length+'/'+maxchamp4);
	$('#produit_produitbundle_souscategorie_contenu').focus();
}else{
	  taille3 = $(this).val();
}
});

var bouge = 1;
var dimension = 200;
function activateelement()
{
var visibility = visibleElement('.animecourant-panel');

if(visibility && bouge == 0){
	bouge = 1;
	$('.toutleblock').css('position','relative');
	$('.toutleblock').css('bottom','0px');
	$('.toutleblock').css('margin-bottom','0px');
}
}

function stopelement()
{
var visibility = visibleElement('.stop-courant-panel');
if(visibility && bouge == 1){
	if(visibleElement('.animecourant-panel') && visibleElement('.stop-courant-panel'))
	{
	
	}else{
	bouge = 0;
	$('.toutleblock').css('position','fixed');
	$('.toutleblock').css('width',dimension+'px');
	$('.toutleblock').css('bottom','7px');
	$('.toutleblock').css('margin-bottom','165px');
	}
}
}

var idStopelement = 0;
var idActivateelement = 0;
function controlScroll()
{
	var largeur = ($(window).width());
	dimension = $('.toutleblock').width();
	if (largeur >= 768)
	{
	   /*
		if(visibleElement('.animecourant-panel') && visibleElement('.stop-courant-panel'))
		{
		
		$('.toutleblock').css('position','fixed');
		$('.toutleblock').css('width',dimension+'px'); 
		}else{ 
		idStopelement = window.setInterval(function() { stopelement(); }, 100);
		idActivateelement = window.setInterval(function() { activateelement(); }, 100);
		} */
		idStopelement = window.setInterval(function() { stopelement(); }, 100);
		idActivateelement = window.setInterval(function() { activateelement(); }, 100);
	}
}
controlScroll();

</script>			
{% endblock %}

{% block javascripttemplate %}
$('.categorie-produit').addClass('position-user');
{% endblock %}